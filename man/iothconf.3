.\" Copyright (C) 2022 VirtualSquare. Project Leader: Renzo Davoli
.\"
.\" This is free documentation; you can redistribute it and/or
.\" modify it under the terms of the GNU General Public License,
.\" as published by the Free Software Foundation, either version 2
.\" of the License, or (at your option) any later version.
.\"
.\" The GNU General Public License's references to "object code"
.\" and "executables" are to be interpreted as the output of any
.\" document formatting or typesetting system, including
.\" intermediate and printed output.
.\"
.\" This manual is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public
.\" License along with this manual; if not, write to the Free
.\" Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston,
.\" MA 02110-1301 USA.
.\"
.\" Automatically generated by Pandoc 2.17.1.1
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "IOTHCONF" "3" "July 2023" "VirtualSquare" "Library Functions Manual"
.hy
.SH NAME
.PP
ioth_config, ioth_resolvconf, ioth_newstackc \[en] Internet of Threads
stack configuration library
.SH SYNOPSIS
.PP
\f[V]#include <iothconf.h>\f[R]
.PP
\f[V]int ioth_config(struct ioth *\f[R]\f[I]stack\f[R]\f[V], char *\f[R]\f[I]config\f[R]\f[V]);\f[R]
.PP
\f[V]struct ioth *ioth_newstackc(const char *\f[R]\f[I]stack_config\f[R]\f[V]);\f[R]
.PP
\f[V]char *ioth_resolvconf(struct ioth *\f[R]\f[I]stack\f[R]\f[V], char *\f[R]\f[I]config\f[R]\f[V]);\f[R]
.PP
These functions are provided by libiothconf.
Link with -liothconf.
.SH DESCRIPTION
.PP
The \f[V]iothconf\f[R] library provides a simple way to configure
Internet of Threads networking stacks.
All the configuration parameters are specified by a character string.
\f[V]iothconf\f[R] can use four sources of data to configure an
\f[V]ioth\f[R] stack:
.IP \[bu] 2
static data (IPv4 and/or IPv6)
.PD 0
.P
.PD
.IP \[bu] 2
DHCP (IPv4, RFC 2131 and 6843)
.PD 0
.P
.PD
.IP \[bu] 2
router discovery (IPv6, RFC 4861)
.PD 0
.P
.PD
.IP \[bu] 2
DHCPv6 (IPv6, RFC 8415 and 4704)
.RS 2
.TP
\f[V]ioth_config\f[R]
\f[V]ioth_config\f[R] configures the stack whose descriptor is
\f[I]stack\f[R] using the parameters written in \f[I]config\f[R].
.TP
\f[V]ioth_newstackc\f[R]
\f[V]ioth_newstackc\f[R] is a shortcut to create a stack and configure
it.
It is equivalent to a sequence \f[V]ioth_newstack\f[R] and
\f[V]ioth_config\f[R].
.TP
\f[V]ioth_resolvconf\f[R]
\f[V]ioth_resolvconf\f[R] retrieves a configuration string for the
domain name resolution library.
.RE
.SS Configuration strings syntax
.PP
\f[V]ioth_config\f[R] configuration string is a comma separated list of
flags and variable assignments:
.IP \[bu] 2
\f[V]iface=...\f[R] : select the interface e.g.\ \f[V]iface=eth0\f[R]
(default value \f[V]vde0\f[R])
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]ifindex=...\f[R] : id of the interface (it can be used instead of
iface)
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]fqdn=...\f[R].
: set the fully qualified domain name for dhcp, dhcpv6
slaac-hash-autoconf
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]mac=...\f[R] : (or \f[V]macaddr\f[R]) define the macaddr for eth
here below.
(e.g.\ \f[V]eth,mac=10:a1:b2:c3:d4:e5\f[R])
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]eth\f[R] : turn on the interface (and set the MAC address if
requested or a hash based MAC address if fqdn is defined)
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]dhcp\f[R] : (or \f[V]dhcp4\f[R] or \f[V]dhcpv4\f[R]) use dhcp
(IPv4)
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]dhcp6\f[R] : (or \f[V]dhcpv6\f[R]) use dhcpv6 (for IPv6)
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]rd\f[R] : (or \f[V]rd6\f[R]) use the router discovery protocol
(IPv6)
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]slaac\f[R] : use stateless auto-configuration (IPv6) (requires rd)
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]auto\f[R] : shortcut for \f[V]eth,dhcp,dhcp6,rd\f[R]
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]auto4\f[R] : (or \f[V]autov4\f[R]) shortcut for \f[V]eth,dhcp\f[R]
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]auto6\f[R] : (or \f[V]autov6\f[R]) shortcut for
\f[V]eth,dhcp6,rd\f[R]
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]ip=..../..\f[R] : set a static address IPv4 or IPv6 and its prefix
length example: \f[V]ip=10.0.0.100/24\f[R] or
\f[V]ip=2001:760:1:2::100/64\f[R]
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]gw=.....\f[R] : set a static default route IPv4 or IPv6
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]dns=....\f[R] : set a static address for a DNS server
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]domain=....\f[R] : set a static domain for the dns search
.PP
\f[V]ioth_newstackc\f[R] supports all the options of ioth_config plus:
.IP \[bu] 2
\f[V]stack=...\f[R] : to select the stack implementation;
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]vnl=...\f[R] : to select the VDE network.
.PP
\f[V]ioth_resolvconf\f[R] configuration string is a comma separated list
of variable assignments:
.IP \[bu] 2
\f[V]iface=...\f[R] : select the interface e.g.\ \f[V]iface=eth0\f[R]
(default value \f[V]vde0\f[R])
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]ifindex=...\f[R] : id of the interface (it can be used instead of
iface)
.SH RETURN VALUE
.PP
\f[V]ioth_config\f[R] returns -1 in case of error and or a mask of the
following bits: each bit is set on if the corresponding configuration
succeeded:
.IP \[bu] 2
\f[V]IOTHCONF_STATIC\f[R]: static IP
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]IOTHCONF_ETH\f[R]: Ethernet
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]IOTHCONF_DHCP\f[R]: DHCPv4
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]IOTHCONF_DHCPV6\f[R]: DHCPv6
.PD 0
.P
.PD
.IP \[bu] 2
\f[V]IOTHCONF_RD\f[R]: neighbor discovery (router advertisement).
.PP
\f[V]ioth_newstackc\f[R] returns the IoTh descriptor, NULL in case of
error
.PP
\f[V]ioth_resolvconf\f[R] returns a configuration string for the domain
name resolution library.
The syntax of the returned string is consistent with
\f[V]resolv.conf\f[R](5).
(the string is dynamically allocated: use \f[V]free\f[R](3) to
deallocate it) It returns NULL and errno = 0 if nothing changed since
the previous call.
In case of error it returns NULL and errno != 0
.SH SEE ALSO
.PP
ioth(3)
.SH AUTHOR
.PP
VirtualSquare.
Project leader: Renzo Davoli
